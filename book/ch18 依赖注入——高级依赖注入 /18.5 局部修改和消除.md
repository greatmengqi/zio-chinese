# 18.5 局部修改和消除
我们已经了解了如何使用ProvideSome运算符部分消除环境的某些部分。
```
val databaseLayer: ZLayer[Any, Nothing, Database] = ???

val effect: ZIO[Database with Logging, Nothing, Unit] = ???

val partiallyEliminated: ZIO[Logging, Nothing, Unit] = effect.provideSomeLayer[Logging](databaseLayer)
```
ProvideSomeLayer运算符使我们能够提供效果所需的一些服务，同时保留其他服务供以后提供。
ZLayer除了能够部分消除环境外，还为我们提供了另一项功能，即可以在本地修改环境的某些部分。
例如，考虑一个Config服务，该服务包含要用于我们的应用程序的默认设置，例如应使用的并行级别。
```
  type Config = Has[Config.Service]
  object Config {
  
    trait Service {
      def defaultParallelism: Int
    }
    
    val default: ZLayer[Any, Nothing, Config] = ZLayer.succeed {
      new Service {
        val defaultParallelism = 4
      }
    }
    
  }
```

我们可能想为我们的应用程序更新默认的并行性。 做到这一点的一种方法是使用ZLayer＃update运算符，该运算符允许我们更新一个层输出的服务之一。
```
  val modified: ZLayer[Any, Nothing, Config] = default.update {
    config =>
      new Config.Service {
        val defaultParallelism = config.defaultParallelism * 2
      }
  }
```
我们还可以使用ZIO＃updateService操作符直接执行此操作：
```
  val zio: ZIO[Config, Nothing, Unit] = ???
  val withUpdatedConfig: ZIO[Config, Nothing, Unit] = zio.updateService[Config] {
    config =>
      new Config.Service {
        val defaultParallelism = config.defaultParallelism * 2
      }
  }

```
请注意，当我们在ZLayer上调用update时，我们拥有一个现有的Config服务并正在对其进行修改。 当我们在效果上调用updateService时，是说在运行效果之前，我们为此效果提供的任何服务都将被修改。