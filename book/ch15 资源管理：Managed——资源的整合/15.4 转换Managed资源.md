# 15.4 转换Managed资源
我们要了解的下一件事是用于转换managed资源的运算符。
大致来说，我们将讨论三类运算符。

第一个是用于组合ZManaged值的运算符，类似于用于转换ZIO值的现有运算符。这些将包括我们已经讨论过的诸如flatMap，map和zipPar之类的运算符。

回到ZManaged值是具有附加功能，描述终结逻辑的ZIO effect的想法，这些运算符以与转换ZIO值的方式类似的方式转换ZManaged值，并包含用于保留ZManaged值的附加结构的附加逻辑。
例如，ZManaged＃flatMap描述顺序获取两个资源，就像ZIO＃flatMap描述顺序执行两个并发程序一样，并且包含附加逻辑来描述如何组合两个资源的最终确定逻辑，在这种情况下，通过以相反的顺序释放资源。类似地，ZManaged＃zipPar描述了并行获取资源，就像ZIO＃zipPar描述了并行执行并发程序一样，这次添加了附加逻辑以并行释放资源。

我们将看到，在ZIO上定义的大多数运算符也在ZManaged上定义，除了少数直接处理较低级别问题（例如光纤）的异常。
组成ZManaged值的第二组运算符利用ZManaged值提供的附加结构来跟踪与资源关联的终结器，因此没有与ZIO的直接相似。
例如，我们将看到ZManaged上有一个onExitFirst运算符，该运算符允许添加一个新的终结器，该终结器将在现有终结器之前运行。 因为ZIO没有以与该效果相关联的终结器的方式来跟踪该操作符的概念，因此该操作符在ZIO上的定义不是很好，但在ZManaged上却定义得很好。
这些运算符使我们能够修改与ZManaged值关联的采集或终止逻辑。
组成ZManaged值的最后一组运算符是允许分隔ZManaged的获取和释放操作的运算符。
通常，我们不希望这样做。 ZManaged的好处是它将获取和释放操作保持在一起，并确保它们始终以正确的方式组成和执行。
例如，如果我们将打开文件句柄和关闭文件句柄的效果分开，则可以打开文件而忘记关闭文件，或者会造成可能被打扰而无法接近文件句柄的情况，而如果我们使用ZManaged并使用永远不会发生的方式。这就是我们首先要使用方括号和ZManaged等抽象的全部原因！
但是，对于某些更高级的用例，有时我们需要分离获取和释放操作，以不同的方式重新组合它们。在执行此操作时，我们需要非常小心以确保我们不会意外引入错误，并且通常希望最后将两种影响组合回一个新的ZManaged值，以便我们获得相同的安全保证，但是ZManaged提供者提供了几种工具帮助我们做到这一点。
关于ZManaged的高级用法的下一章将介绍第三组运算符，但为完整起见，在此将其提及。